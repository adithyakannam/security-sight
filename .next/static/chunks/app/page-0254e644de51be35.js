(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6624:(e,t,s)=>{Promise.resolve().then(s.bind(s,8192))},8192:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(5155),a=s(2115);let l=()=>(0,r.jsx)("nav",{className:"bg-gray-900 text-white px-6 py-4 shadow-lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center space-x-3",children:(0,r.jsxs)("svg",{width:"121",height:"26",viewBox:"0 0 121 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M5.29392 10.075V22.75L8.30761 26L8.47052 15.7354L10.1538 16.7917L11.9186 15.7354V26L15.0137 22.75V10.075L10.1538 13.1354L5.29392 10.075Z",fill:"white"}),(0,r.jsx)("path",{d:"M0 3.8147e-06V17.0354L3.39379 20.6916V6.44583L10.0998 10.6709L16.9688 6.44583V20.6916L20.3897 17.0354V3.8147e-06L10.0998 6.44583L0 3.8147e-06Z",fill:"white"}),(0,r.jsx)("path",{d:"M32.1336 19.5V7.58H33.2536L37.7336 14.076H37.1096L41.5736 7.58H42.6936V19.5H41.4136V9.308L41.8296 9.468L37.4456 15.82H37.3816L33.0136 9.468L33.4136 9.308V19.5H32.1336ZM44.2766 19.5L48.6286 7.58H50.0046L54.3566 19.5H53.0126L51.9886 16.588H46.6606L45.6206 19.5H44.2766ZM47.0766 15.388H51.5406L49.1246 8.54H49.5086L47.0766 15.388ZM55.9461 19.5V7.58H57.0661L64.0581 17.612H63.6261V7.58H64.9061V19.5H63.7861L56.7941 9.404H57.2261V19.5H55.9461ZM67.7273 19.5V7.58H71.6473C72.8313 7.58 73.8607 7.82533 74.7353 8.316C75.61 8.796 76.2873 9.484 76.7673 10.38C77.2473 11.2653 77.4873 12.316 77.4873 13.532C77.4873 14.7373 77.2473 15.788 76.7673 16.684C76.2873 17.58 75.61 18.2733 74.7353 18.764C73.8607 19.2547 72.8313 19.5 71.6473 19.5H67.7273ZM69.0073 18.3H71.6473C72.5647 18.3 73.3593 18.108 74.0313 17.724C74.7033 17.3293 75.2207 16.7747 75.5833 16.06C75.9567 15.3453 76.1433 14.5027 76.1433 13.532C76.1433 12.5613 75.9567 11.724 75.5833 11.02C75.21 10.3053 74.6873 9.756 74.0153 9.372C73.3433 8.97733 72.554 8.78 71.6473 8.78H69.0073V18.3ZM79.6023 19.5V7.58H80.8823V18.3H86.1623V19.5H79.6023ZM86.8703 19.5L91.2223 7.58H92.5983L96.9503 19.5H95.6063L94.5823 16.588H89.2543L88.2143 19.5H86.8703ZM89.6703 15.388H94.1343L91.7183 8.54H92.1023L89.6703 15.388ZM103.495 19.692C102.653 19.692 101.879 19.5427 101.175 19.244C100.471 18.9347 99.8581 18.508 99.3355 17.964C98.8235 17.4093 98.4235 16.7587 98.1355 16.012C97.8475 15.2653 97.7035 14.444 97.7035 13.548C97.7035 12.652 97.8475 11.8307 98.1355 11.084C98.4235 10.3373 98.8235 9.68667 99.3355 9.132C99.8581 8.57733 100.471 8.15067 101.175 7.852C101.879 7.54267 102.653 7.388 103.495 7.388C104.306 7.388 105.031 7.532 105.671 7.82C106.322 8.108 106.866 8.48133 107.303 8.94C107.751 9.388 108.071 9.86267 108.263 10.364L107.063 10.892C106.765 10.1987 106.306 9.644 105.687 9.228C105.079 8.80133 104.349 8.588 103.495 8.588C102.621 8.588 101.842 8.796 101.159 9.212C100.477 9.628 99.9435 10.2093 99.5595 10.956C99.1755 11.692 98.9835 12.556 98.9835 13.548C98.9835 14.5293 99.1755 15.3933 99.5595 16.14C99.9435 16.8867 100.477 17.468 101.159 17.884C101.842 18.2893 102.621 18.492 103.495 18.492C104.349 18.492 105.079 18.284 105.687 17.868C106.306 17.452 106.765 16.8973 107.063 16.204L108.263 16.732C108.071 17.2227 107.751 17.6973 107.303 18.156C106.866 18.604 106.322 18.972 105.671 19.26C105.031 19.548 104.306 19.692 103.495 19.692ZM109.323 19.5L113.227 13.532L109.323 7.58H112.171L115.307 12.348H113.915L117.035 7.58H119.883L115.995 13.532L119.883 19.5H117.035L113.915 14.716L115.307 14.732L112.171 19.5H109.323Z",fill:"white"})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("button",{className:"px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors bg-blue-600 text-white",children:"Dashboard"}),(0,r.jsx)("button",{className:"px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors text-gray-300",children:"Cameras"}),(0,r.jsx)("button",{className:"px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors text-gray-300",children:"Scenes"}),(0,r.jsx)("button",{className:"px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors text-gray-300",children:"Incidents"}),(0,r.jsx)("button",{className:"px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors text-gray-300",children:"Users"})]}),(0,r.jsx)("div",{className:"flex items-center space-x-6",children:(0,r.jsx)("div",{className:"flex flex-col items-end",children:(0,r.jsxs)("button",{className:"flex items-center space-x-2 bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-lg text-sm font-semibold text-white transition-colors shadow",children:[(0,r.jsx)("span",{className:"w-6 h-6 bg-gray-600 rounded-full flex items-center justify-center text-xs font-bold",children:"A"}),(0,r.jsx)("span",{children:"Adithya"})," ",(0,r.jsx)("br",{})]})})})]})});var i=s(6766);let n=e=>{let{selectedIncident:t,allIncidents:s,onSelectIncident:l}=e,[n,c]=(0,a.useState)(!1),[d,o]=(0,a.useState)("00:00"),[x]=(0,a.useState)("02:45"),m=()=>{c(!n)},h=s.filter(e=>e.id!==(null==t?void 0:t.id)).slice(0,2);return(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white mb-2",children:"Incident Player"}),t?(0,r.jsxs)("p",{className:"text-sm text-gray-300",children:["Playing: ",t.type," - ",t.camera.name]}):(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Select an incident to view"})]}),(0,r.jsx)("div",{className:"relative bg-black rounded-lg overflow-hidden mb-4",style:{aspectRatio:"16/9"},children:t?(0,r.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center",children:[(0,r.jsxs)("div",{className:"w-full h-full relative",children:[(0,r.jsx)(i.default,{src:t.thumbnailUrl,alt:"".concat(t.type," incident"),fill:!0,className:"object-cover",onError:e=>{let t=e.target;t.src.includes("suspicious-activity-1.svg")||(t.src="/thumbnails/suspicious-activity-1.svg")}}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center  bg-opacity-40",children:(0,r.jsx)("button",{onClick:m,className:"w-16 h-16 bg-white bg-opacity-90 rounded-full flex items-center justify-center hover:bg-opacity-100 transition-all",children:n?(0,r.jsx)("div",{className:"w-4 h-4 bg-gray-800"}):(0,r.jsx)("div",{className:"w-0 h-0 border-l-6 border-l-gray-800 border-t-3 border-b-3 border-t-transparent border-b-transparent ml-1"})})})]}),(0,r.jsx)("div",{className:"absolute top-4 left-4 bg-red-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:t.type}),(0,r.jsx)("div",{className:"absolute bottom-4 left-4 bg-black bg-opacity-60 text-white px-2 py-1 rounded text-sm",children:t.camera.name}),(0,r.jsx)("div",{className:"absolute top-12 left-4 bg-black bg-opacity-60 text-white px-2 py-1 rounded text-sm",children:new Date(t.tsStart).toLocaleTimeString()}),(0,r.jsx)("div",{className:"absolute bottom-4 right-4 mb-4 max-w-xs ",children:(0,r.jsxs)("div",{className:"flex space-x-3",children:[h.map(e=>(0,r.jsxs)("div",{className:"relative w-32 h-20 bg-gray-700 rounded overflow-hidden cursor-pointer hover:ring-2 hover:ring-blue-500 transition-all",onClick:()=>{l&&l(e)},children:[(0,r.jsx)(i.default,{src:e.thumbnailUrl,alt:"".concat(e.camera.name," thumbnail"),fill:!0,className:"object-cover",onError:e=>{let t=e.target;t.src.includes("suspicious-activity-1.svg")||(t.src="/thumbnails/suspicious-activity-1.svg")}}),(0,r.jsx)("div",{className:"absolute top-0 left-0 right-0 bg-black bg-opacity-60 text-white text-xs px-1 py-0.5",children:e.camera.name})]},e.id)),Array.from({length:Math.max(0,2-h.length)}).map((e,t)=>(0,r.jsx)("div",{className:"w-32 h-20 bg-gray-600 rounded flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-gray-400 text-xs",children:"No Camera"})},"placeholder-".concat(t)))]})})]}):(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-2 border-gray-600 rounded-full flex items-center justify-center mb-4 mx-auto",children:(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCF9"})}),(0,r.jsx)("p",{className:"text-gray-400",children:"No incident selected"})]})})}),(0,r.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("button",{onClick:m,disabled:!t,className:"w-10 h-10 rounded-full flex items-center justify-center transition-colors ".concat(t?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-600 text-gray-400 cursor-not-allowed"),children:n?(0,r.jsx)("div",{className:"w-3 h-3 bg-current"}):(0,r.jsx)("div",{className:"w-0 h-0 border-l-3 border-l-current border-t-2 border-b-2 border-t-transparent border-b-transparent ml-0.5"})}),(0,r.jsxs)("div",{className:"text-sm text-gray-300",children:[d," / ",x]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{disabled:!t,className:"p-2 rounded transition-colors ".concat(t?"hover:bg-gray-600 text-gray-300":"text-gray-500 cursor-not-allowed"),children:"\uD83D\uDD0A"}),(0,r.jsx)("button",{disabled:!t,className:"p-2 rounded transition-colors ".concat(t?"hover:bg-gray-600 text-gray-300":"text-gray-500 cursor-not-allowed"),children:"⛶"})]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-600 rounded-full h-2",children:(0,r.jsx)("div",{className:"h-2 rounded-full transition-all ".concat(t?"bg-blue-600":"bg-gray-500"),style:{width:t?"35%":"0%"}})})]})]})},c=e=>{let{incidents:t,selectedIncident:s,onSelectIncident:l,onResolveIncident:n}=e,[c,d]=(0,a.useState)([]),o=async(e,t)=>{t.stopPropagation(),d(t=>[...t,e]);try{await n(e),d(t=>t.filter(t=>t!==e))}catch(t){d(t=>t.filter(t=>t!==e))}};return(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-white mb-2",children:"Incident List"}),(0,r.jsxs)("p",{className:"text-sm text-gray-300",children:[t.length," incidents detected"]})]}),(0,r.jsxs)("div",{className:"flex gap-8 text-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-lg font-bold text-red-400",children:t.filter(e=>!e.resolved).length}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"Active"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-lg font-bold text-green-400",children:t.filter(e=>e.resolved).length}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:"Resolved"})]})]})]})}),(0,r.jsx)("div",{className:"space-y-4 max-h-[40rem] overflow-y-auto",children:0===t.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,r.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDEE1️"}),(0,r.jsx)("p",{children:"No incidents detected"}),(0,r.jsx)("p",{className:"text-sm",children:"All systems secure"})]}):t.map(e=>{let t,a=(t=e.id,c.includes(t)),n=e.resolved||a;return(0,r.jsxs)("div",{onClick:()=>l(e),className:"border rounded-lg p-4 cursor-pointer transition-all hover:shadow-md ".concat((null==s?void 0:s.id)===e.id?"border-blue-500 bg-blue-900":"border-gray-600 hover:border-gray-500 bg-gray-700"," ").concat(a?"opacity-60":""),children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3 mb-3",children:[(0,r.jsx)("div",{className:"relative w-16 h-12 bg-gray-600 rounded overflow-hidden flex-shrink-0",children:(0,r.jsx)(i.default,{src:e.thumbnailUrl,alt:"".concat(e.type," thumbnail"),fill:!0,className:"object-cover",onError:e=>{let t=e.target;t.src.includes("data:image")||(t.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQwIiBoZWlnaHQ9IjM2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNjQwIiBoZWlnaHQ9IjM2MCIgZmlsbD0iIzM3NDE1MSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IiM5Q0EzQUYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5JbWFnZSBOb3QgRm91bmQ8L3RleHQ+PC9zdmc+")}})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(n?"bg-green-500":"bg-red-500")}),(0,r.jsx)("span",{className:"font-medium text-white truncate",children:e.type})]}),!n&&(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded border ".concat((e=>{switch(e.toLowerCase()){case"unauthorized access":case"gun threat":return"bg-red-900 text-red-200 border-red-800";case"suspicious activity":return"bg-yellow-900 text-yellow-200 border-yellow-800";case"motion detection":return"bg-blue-900 text-blue-200 border-blue-800";case"face recognised":return"bg-green-900 text-green-200 border-green-800";case"vehicle intrusion":return"bg-orange-900 text-orange-200 border-orange-800";case"equipment tampering":return"bg-purple-900 text-purple-200 border-purple-800";case"loitering":return"bg-indigo-900 text-indigo-200 border-indigo-800";default:return"bg-gray-700 text-gray-200 border-gray-600"}})(e.type)," flex-shrink-0"),children:e.type.split(" ")[0]})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-300 space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Camera:"})," ",e.camera.name]}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Time:"})," ",new Date(e.tsStart).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Location:"})," ",e.camera.location]}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Duration:"})," ",((e,t)=>{if(!t)return"Ongoing";let s=new Date(e).getTime(),r=new Date(t).getTime()-s,a=Math.floor(r/6e4),l=Math.floor(r%6e4/1e3);return"".concat(a,":").concat(l.toString().padStart(2,"0"))})(e.tsStart,e.tsEnd)]})]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center pt-3 border-t border-gray-600",children:[(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{className:"text-xs bg-blue-800 text-blue-200 px-2 py-1 rounded hover:bg-blue-700 transition-colors",children:"View Details"}),!n&&(0,r.jsx)("button",{onClick:t=>o(e.id,t),disabled:a,className:"text-xs px-2 py-1 rounded transition-colors ".concat(a?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-green-800 text-green-200 hover:bg-green-700"),children:a?"Resolving...":"Mark Resolved"})]}),(0,r.jsx)("span",{className:"text-xs ".concat(n?"text-green-400":"text-red-400"," font-medium"),children:n?"Resolved":"Active"})]})]},e.id)})})]})};function d(){let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)(null),[d,o]=(0,a.useState)(!0),x=(0,a.useCallback)(async e=>{try{o(!0);let s=await fetch("/api/incidents".concat(void 0!==e?"?resolved=".concat(e):""));if(!s.ok)throw Error("Failed to fetch incidents");let r=await s.json();t(r)}catch(e){console.error("Error fetching incidents:",e)}finally{o(!1)}},[]),m=(0,a.useRef)(!1);(0,a.useEffect)(()=>{m.current||(m.current=!0,x())},[]);let h=(0,a.useCallback)(e=>{i(e)},[]),g=(0,a.useCallback)(async e=>{try{let r=await fetch("/api/incidents/".concat(e,"/resolve"),{method:"PATCH"});if(!r.ok)throw Error("Failed to resolve incident");let a=await r.json();t(t=>t.map(t=>t.id===e?a:t)),(null==s?void 0:s.id)===e&&i(a)}catch(e){throw console.error("❌ Error resolving incident:",e),e}},[s]);return d?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900",children:[(0,r.jsx)(l,{}),(0,r.jsx)("div",{className:"container mx-auto px-6 py-6",children:(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-white",children:"Loading incidents..."})]})})})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900",children:[(0,r.jsx)(l,{}),(0,r.jsxs)("div",{className:" mx-auto px-6 py-1 border border-gray-700 bg-gray-800 rounded-lg p-5",children:[(0,r.jsx)("div",{className:"mb-1 flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Security Dashboard"})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsx)(n,{selectedIncident:s,allIncidents:e,onSelectIncident:h})}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsx)(c,{incidents:e,selectedIncident:s,onSelectIncident:h,onResolveIncident:g})})]})]})]})}}},e=>{e.O(0,[766,441,964,358],()=>e(e.s=6624)),_N_E=e.O()}]);